# المرحلة الرابعة: دمج عرض المحتوى من منصات التواصل الاجتماعي وتحليلاتها

## نظرة عامة

تركز المرحلة الرابعة على تطوير ميزات عرض وتحليل محتوى التواصل الاجتماعي، بما في ذلك:

1. **تجميع المحتوى الاجتماعي**: جلب وعرض المنشورات من منصات مختلفة في تغذية موحدة
2. **تحليلات التواصل الاجتماعي**: تحليل الأداء والتفاعل والاتجاهات

## الملفات المنفذة

### 1. `phase4_social_content_aggregator.py`

خدمة شاملة لتجميع وعرض محتوى التواصل الاجتماعي.

#### المكونات الرئيسية:

**فئة SocialPost**:
```python
@dataclass
class SocialPost:
    id: str
    platform: str
    author: str
    author_avatar: str
    content: str
    timestamp: datetime
    likes: int = 0
    comments: int = 0
    shares: int = 0
    media_urls: List[str] = None
    url: str = None
    hashtags: List[str] = None
```

**موفرو المحتوى الاجتماعي**:
- `TwitterProvider`: جلب التغريدات
- `FacebookProvider`: جلب منشورات الفيسبوك
- `LinkedInProvider`: جلب منشورات لينكدإن

#### الميزات الرئيسية:

1. **تجميع المحتوى من عدة منصات**:
```python
aggregator = ContentAggregator()
aggregator.register_provider('twitter', twitter_provider)
aggregator.register_provider('facebook', facebook_provider)

# الحصول على تغذية موحدة
feed = aggregator.fetch_aggregated_feed(limit=50)
```

2. **تغذية لكل منصة**:
```python
twitter_feed = aggregator.get_platform_feed('twitter', limit=20)
```

3. **التخزين المؤقت (Caching)**:
```python
# تخزين مؤقت لمدة 15 دقيقة
aggregator.clear_cache('twitter')  # مسح الذاكرة المؤقتة
```

4. **عرض المحتوى**:
```html
<div class="social-feed">
    <!-- تم إنشاؤه بواسطة SocialFeedWidget.generate_feed_html() -->
</div>
```

### 2. `phase4_social_analytics.py`

خدمة شاملة لتحليلات التواصل الاجتماعي.

#### المكونات الرئيسية:

**فئة EngagementMetrics**:
```python
@dataclass
class EngagementMetrics:
    post_id: str
    platform: str
    likes: int
    comments: int
    shares: int
    impressions: int = 0
    reach: int = 0
    timestamp: datetime = None
```

**حاسبة التحليلات**:
- `calculate_engagement_rate()`: حساب معدل التفاعل
- `calculate_sentiment_score()`: حساب درجة المشاعر
- `calculate_growth_rate()`: حساب معدل النمو

**لوحة التحكم التحليلية**:
- `SocialAnalyticsDashboard`: إدارة البيانات والحسابات

#### الميزات الرئيسية:

1. **حساب معدل التفاعل**:
```python
engagement_rate = AnalyticsCalculator.calculate_engagement_rate(
    likes=150,
    comments=20,
    shares=30,
    reach=10000
)
# النتيجة: 2.0%
```

2. **تحليل المشاعر**:
```python
sentiment = AnalyticsCalculator.calculate_sentiment_score(comments)
# النتيجة: بين -1 (سلبي) و 1 (إيجابي)
```

3. **إحصائيات المنصة**:
```python
stats = dashboard.calculate_all_stats()
for platform, stat in stats.items():
    print(f"{platform}: {stat.total_engagement} تفاعل")
```

4. **أفضل المنشورات**:
```python
top_posts = dashboard.get_top_posts(platform='twitter', limit=10)
```

5. **اتجاهات التفاعل**:
```python
trend = dashboard.get_engagement_trend('twitter', days=30)
# قائمة من (التاريخ، التفاعل)
```

6. **أفضل وقت للنشر**:
```python
best_time = dashboard.get_best_posting_time('twitter')
# النتيجة: "14:00"
```

## التكامل مع النظام

### 1. في الصفحة الرئيسية:

```html
<!-- Social Feed Section -->
<section class="social-feed-section">
    <h2>آخر المنشورات</h2>
    <div id="social-feed">
        <!-- Generated by ContentAggregator -->
    </div>
</section>
```

### 2. في لوحة التحكم:

```html
<!-- Analytics Dashboard -->
<section class="analytics-section">
    <h2>تحليلات التواصل الاجتماعي</h2>
    <div id="analytics-dashboard">
        <!-- Generated by AnalyticsDashboardHTML -->
    </div>
</section>
```

### 3. في النموذج الخلفي (Backend):

```python
from phase4_social_content_aggregator import content_aggregator
from phase4_social_analytics import social_analytics

# تهيئة المجمع
twitter_provider = TwitterProvider(access_token=settings.TWITTER_TOKEN)
facebook_provider = FacebookProvider(access_token=settings.FACEBOOK_TOKEN)

content_aggregator.register_provider('twitter', twitter_provider)
content_aggregator.register_provider('facebook', facebook_provider)

# جلب التغذية
@app.route('/api/social-feed')
def get_social_feed():
    feed = content_aggregator.fetch_aggregated_feed(limit=50)
    return {
        'posts': [post.to_dict() for post in feed]
    }

# الحصول على التحليلات
@app.route('/api/social-analytics')
def get_analytics():
    stats = social_analytics.calculate_all_stats()
    return {
        'stats': {k: v.__dict__ for k, v in stats.items()}
    }
```

## متطلبات التثبيت

```bash
pip install requests
```

## متطلبات الإعدادات

### متغيرات البيئة:

```bash
# Twitter API
TWITTER_API_KEY=your-api-key
TWITTER_API_SECRET=your-api-secret
TWITTER_ACCESS_TOKEN=your-access-token
TWITTER_ACCESS_TOKEN_SECRET=your-token-secret

# Facebook API
FACEBOOK_APP_ID=your-app-id
FACEBOOK_APP_SECRET=your-app-secret
FACEBOOK_PAGE_ACCESS_TOKEN=your-page-token

# LinkedIn API
LINKEDIN_CLIENT_ID=your-client-id
LINKEDIN_CLIENT_SECRET=your-client-secret
LINKEDIN_ACCESS_TOKEN=your-access-token
```

## أمثلة الاستخدام

### مثال 1: عرض التغذية الموحدة

```python
from phase4_social_content_aggregator import content_aggregator, ContentAggregator
from phase4_social_content_aggregator import TwitterProvider, FacebookProvider

# إعداد المجمع
aggregator = ContentAggregator()
twitter = TwitterProvider(access_token="...")
facebook = FacebookProvider(access_token="...")

aggregator.register_provider('twitter', twitter)
aggregator.register_provider('facebook', facebook)

# جلب التغذية
feed = aggregator.fetch_aggregated_feed(limit=20)

# عرض المنشورات
for post in feed:
    print(f"{post.author} ({post.platform}): {post.content[:50]}...")
```

### مثال 2: تحليل الأداء

```python
from phase4_social_analytics import SocialAnalyticsDashboard, EngagementMetrics
from datetime import datetime

# إنشاء لوحة التحكم
dashboard = SocialAnalyticsDashboard()

# إضافة البيانات
metrics = EngagementMetrics(
    post_id='123',
    platform='twitter',
    likes=150,
    comments=20,
    shares=30,
    impressions=5000,
    reach=10000,
    timestamp=datetime.utcnow()
)
dashboard.add_metrics(metrics)

# حساب الإحصائيات
stats = dashboard.calculate_all_stats()
print(f"معدل التفاعل: {stats['twitter'].average_engagement_rate:.2f}%")

# الحصول على أفضل المنشورات
top_posts = dashboard.get_top_posts(limit=5)
```

### مثال 3: عرض لوحة التحليلات

```python
from phase4_social_analytics import AnalyticsDashboardHTML

# إنشاء HTML
html = AnalyticsDashboardHTML.generate_dashboard(dashboard)

# حفظ في ملف
with open('analytics.html', 'w', encoding='utf-8') as f:
    f.write(html)
```

## الخطوات التالية

### في المرحلة الرابعة:

1. **اختبار الجلب**: اختبار جلب المحتوى من جميع المنصات
2. **تحسين الأداء**: تحسين سرعة جلب البيانات والتخزين المؤقت
3. **تحسين الواجهة**: تحسين عرض التغذية والتحليلات

### في المراحل القادمة:

1. **الجدولة التلقائية**: جدولة المنشورات على التواصل الاجتماعي
2. **التنبيهات الذكية**: تنبيهات عند تحقيق أهداف الأداء
3. **المقارنة المتقدمة**: مقارنة الأداء بين المنصات والفترات الزمنية

## الخلاصة

توفر المرحلة الرابعة تكاملاً شاملاً لعرض وتحليل محتوى التواصل الاجتماعي، مما يسمح للمستخدمين برؤية جميع منشوراتهم في مكان واحد وتحليل أداء كل منصة. هذا يوفر رؤى قيمة لتحسين استراتيجية التواصل الاجتماعي.
