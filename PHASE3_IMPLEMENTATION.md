# المرحلة الثالثة: دمج ميزات المشاركة الاجتماعية وتسجيل الدخول عبر التواصل الاجتماعي

## نظرة عامة

تركز المرحلة الثالثة على تطوير ميزات التكامل مع منصات التواصل الاجتماعي، بما في ذلك:

1. **خدمة المشاركة الاجتماعية**: السماح للمستخدمين بمشاركة المحتوى على منصات التواصل الاجتماعي
2. **تسجيل الدخول الاجتماعي**: السماح للمستخدمين بتسجيل الدخول باستخدام حساباتهم على التواصل الاجتماعي

## الملفات المنفذة

### 1. `phase3_social_sharing_service.py`

خدمة شاملة لمشاركة المحتوى على منصات التواصل الاجتماعي.

#### المكونات الرئيسية:

**فئات منصات التواصل الاجتماعي**:
- `TwitterShare`: مشاركة على تويتر
- `FacebookShare`: مشاركة على فيسبوك
- `LinkedInShare`: مشاركة على لينكدإن
- `WhatsAppShare`: مشاركة على واتساب
- `EmailShare`: مشاركة عبر البريد الإلكتروني

**مولد علامات Meta**:
- `MetaTagGenerator`: إنشاء علامات Open Graph و Twitter Cards

**مدير المشاركة الاجتماعية**:
- `SocialSharingManager`: إدارة المشاركات والإحصائيات

**مكونات HTML**:
- `ShareButton`: أزرار المشاركة
- `ShareWidget`: عنصر واجهة المشاركة الكامل

#### الميزات الرئيسية:

1. **روابط مشاركة موحدة**:
```python
content = {
    'url': 'https://idea-system.com/project/123',
    'text': 'تحقق من مشروعنا الجديد',
    'hashtags': 'IDEA,مشاريع',
}

manager = SocialSharingManager()
share_links = manager.get_share_links(content)
```

2. **علامات Meta للمشاركة الاجتماعية**:
```python
meta_tags = MetaTagGenerator.generate_html_meta_tags(content)
```

3. **تتبع المشاركات**:
```python
manager.track_share('twitter', 'project_123', 'user_456')
stats = manager.get_share_stats('project_123')
```

4. **أزرار مشاركة HTML**:
```html
<div class="share-buttons">
    <a href="..." class="share-btn share-btn-twitter">تويتر</a>
    <a href="..." class="share-btn share-btn-facebook">فيسبوك</a>
    ...
</div>
```

### 2. `phase3_social_login_service.py`

خدمة OAuth 2.0 لتسجيل الدخول عبر التواصل الاجتماعي.

#### المكونات الرئيسية:

**فئات موفري OAuth**:
- `GoogleOAuthProvider`: تسجيل الدخول عبر جوجل
- `FacebookOAuthProvider`: تسجيل الدخول عبر فيسبوك
- `GitHubOAuthProvider`: تسجيل الدخول عبر جيتهاب

**مدير تسجيل الدخول الاجتماعي**:
- `SocialLoginManager`: إدارة عمليات تسجيل الدخول

**مكونات HTML**:
- `SocialLoginButton`: أزرار تسجيل الدخول

#### الميزات الرئيسية:

1. **تسجيل موفري OAuth**:
```python
manager = SocialLoginManager()

google_provider = GoogleOAuthProvider(
    client_id="...",
    client_secret="...",
    redirect_uri="..."
)

manager.register_provider('google', google_provider)
```

2. **الحصول على رابط التفويض**:
```python
auth_url, state = manager.get_authorization_url('google')
```

3. **معالجة رد الاتصال**:
```python
user_info = manager.handle_callback('google', code, state)
```

4. **ربط الحسابات الاجتماعية**:
```python
manager.link_social_account('user_123', 'google', 'google_id_456')
manager.unlink_social_account('user_123', 'google')
```

5. **أزرار تسجيل الدخول HTML**:
```html
<div class="social-login-buttons">
    <a href="..." class="social-login-btn social-login-google">
        تسجيل الدخول عبر جوجل
    </a>
    <a href="..." class="social-login-btn social-login-facebook">
        تسجيل الدخول عبر فيسبوك
    </a>
    ...
</div>
```

## التكامل مع النظام

### 1. في الصفحة الرئيسية:

```html
<!-- Social Login Buttons -->
<div class="login-section">
    <h2>تسجيل الدخول</h2>
    <div class="social-login-buttons">
        <!-- Generated by SocialLoginButton.generate_buttons() -->
    </div>
</div>
```

### 2. في صفحات المشاريع:

```html
<!-- Share Buttons -->
<div class="share-section">
    <h3>مشاركة المشروع</h3>
    <div class="share-buttons">
        <!-- Generated by ShareButton.generate_share_buttons() -->
    </div>
</div>

<!-- Meta Tags for Social Sharing -->
<!-- Generated by MetaTagGenerator.generate_html_meta_tags() -->
```

### 3. في النموذج الخلفي (Backend):

```python
from phase3_social_login_service import social_login
from phase3_social_sharing_service import social_sharing

# Handle social login callback
@app.route('/auth/<provider>/callback')
def auth_callback(provider):
    code = request.args.get('code')
    state = request.args.get('state')
    
    try:
        result = social_login.handle_callback(provider, code, state)
        user_info = result['user']
        
        # Create or update user in database
        user = User.objects.get_or_create(
            email=user_info['email'],
            defaults={
                'name': user_info['name'],
                'avatar': user_info['picture'],
            }
        )
        
        # Link social account
        social_login.link_social_account(user.id, provider, user_info['id'])
        
        # Create session
        login(request, user)
        return redirect('/')
    except Exception as e:
        return redirect(f'/login?error={str(e)}')

# Track social shares
@app.route('/api/track-share', methods=['POST'])
def track_share():
    data = request.json
    social_sharing.track_share(
        data['platform'],
        data['content_id'],
        data.get('user_id')
    )
    return {'status': 'success'}
```

## متطلبات التثبيت

```bash
pip install requests
```

## متطلبات الإعدادات

### متغيرات البيئة:

```bash
# Google OAuth
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret

# Facebook OAuth
FACEBOOK_APP_ID=your-facebook-app-id
FACEBOOK_APP_SECRET=your-facebook-app-secret

# GitHub OAuth
GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=your-github-client-secret
```

### إعدادات قاعدة البيانات:

```sql
-- Social Account Linking
CREATE TABLE social_accounts (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT NOT NULL,
    provider VARCHAR(50) NOT NULL,
    social_id VARCHAR(255) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id),
    UNIQUE KEY (provider, social_id)
);

-- Share Tracking
CREATE TABLE share_history (
    id INT PRIMARY KEY AUTO_INCREMENT,
    platform VARCHAR(50) NOT NULL,
    content_id VARCHAR(255) NOT NULL,
    user_id INT,
    timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id)
);
```

## الخطوات التالية

### في المرحلة الثالثة:

1. **اختبار OAuth**: اختبار تسجيل الدخول عبر جميع المنصات
2. **تتبع المشاركات**: تحليل بيانات المشاركات
3. **تحسين الواجهة**: تحسين مظهر الأزرار والعناصر

### في المراحل القادمة:

1. **عرض المحتوى من التواصل الاجتماعي**: دمج محتوى من حسابات التواصل الاجتماعي
2. **التحليلات الاجتماعية**: عرض إحصائيات الأداء على التواصل الاجتماعي
3. **الجدولة التلقائية**: جدولة المنشورات على التواصل الاجتماعي

## الخلاصة

توفر المرحلة الثالثة تكاملاً شاملاً مع منصات التواصل الاجتماعي، مما يسمح للمستخدمين بمشاركة المحتوى وتسجيل الدخول باستخدام حساباتهم على التواصل الاجتماعي. هذا يحسن تجربة المستخدم ويزيد من الوصول والتفاعل.
